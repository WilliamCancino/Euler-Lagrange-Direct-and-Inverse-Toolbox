# Euler-Lagrange-Direct-and-Inverse-Toolbox

This repository contains a MATLAB framework designed for the simulation and analysis of dynamic systems using the Euler-Lagrange formulation. The project allows solving both the **direct problem** (simulating the behavior of the system from its known parameters) and the **inverse problem** (estimating unknown parameters of the system from noisy measurements of its behavior).


## üìú General description

The core of this project is the ability to define a dynamical system symbolically through its Lagrangian and its Rayleigh dissipation function. From this definition, the framework automatically derives the equations of motion, solves them numerically and provides tools to visualize the results.

### ‚ú® Main Features

- **Automatic equation derivation:** Uses the Euler-Lagrange formulation to derive the equations of motion symbolically.
- **Direct problem solving:** Simulates the time evolution of the generalized coordinates of the system and generates a visual animation of the motion.
- **Parameter estimation (inverse problem):** Estimates unknown physical parameters (masses, lengths, friction coefficients, etc.) from "measured" data (simulated with noise).
- **Multiple optimization algorithms:** Supports a variety of optimizers to solve the inverse problem, including:
  - Trust-Region-Dogleg (TRD).
  - Levenberg-Marquardt (LMA)
  - Particle Swarm Optimization (PSO)
  - Genetic Algorithm (GA)
  - Stochastic Optimization Strategy (SOS)
  - Simulated Annealing (SA)
  - Pattern Search (PS)
  - Trust-Region-Reflective (TRR)
- **Noise simulation:** Allows to add Additive White Gaussian Noise (AWGN) to the measurements to simulate realistic conditions.
- **Advanced visualization:** Generates comparative graphs and animations in GIF format of the system dynamics.
- **Modular design:** Allows new dynamic systems to be easily defined by creating a single configuration file in the `Variables/` folder.

### üìÇ Project structure.

The repository is organized as follows to separate logic, system definitions and run scripts:

- `RunDirect.m` and `RunInverse.m`: The main scripts for running the **direct** and **inverse** problem for each system.
- `Pictures/`: An automatically created folder that stores all output plots and GIF animations generated by the scripts. Note the file naming convention: `_dp` in a filename indicates a direct problem result, while `_ip` indicates an inverse problem result.
- `Scripts/Animator/`: Contains custom animation scripts for each dynamic system.
- `Scripts/General/`: Includes general-purpose functions: 
  - `DynamicEqSolver.m`, `SsOdeSolver.m` ‚Äì solvers
  - `LagrangeDynamicEqDeriver.m` ‚Äì symbolic derivation of equations
  - `AddNoise.m`, `PlotEq.m`, etc. ‚Äì utilities
- `Variables/`: Holds the symbolic and physical definitions of each system.


## ‚öôÔ∏è How to Use

### 1. Direct problem

Use `RunDirect` to simulate the behavior of a system when you know all its parameters.

#### üîß Syntax

```matlab
RunDirect(num_ex, opt_awgn, dBs)
```

#### üì• Parameters
- **num_ex (Integer):** The ID of the system to simulate (e.g., 1 for Vars01.m).
- **opt_awgn (String, Optional):** Determines how noise is displayed in the plot.
  - 'normal': No noise (default)
  - 'noise': Adds Gaussian noise
  - 'both': Shows both the clean and noisy results
- **dBs (Integer, Optional):** Signal-to-noise ratio (in dB), required if opt_awgn is 'noise' or 'both'.

#### ‚úÖ Examples
```matlab
% Basic simulation of system 1 with no noise
RunDirect(1)

% Simulate system 1 and plot only the noisy results (SNR = 20 [dB])
RunDirect(1, 'noise', 20)

% Simulate system 1 and plot both the clean and noisy results (SNR = 15 [dB])
RunDirect(1, 'both', 15)
```

### 2. Inverse problem
Use `RunInverse` to estimate a system's unknown parameters based on "measured" data.

#### üîß Syntax
```matlab
RunInverse(num_ex, dBs, method)
```

#### üì• Parameters
- **num_ex (Integer):** The ID of the system to analyze.
- **dBs (Integer, Optional):** The Signal-to-noise ratio (in dB) used to generate the "measured" data. Defaults to 20 [dB].
- **method (String or Integer, Optional):** The optimization algorithm to use. Defaults to 'PSO' (Particle Swarm Optimization).
  
#### ‚úÖ Examples
```matlab
% Basic estimation for system 1 using default noise (20 dB) and optimizer (PSO)
RunInverse(1)

% Estimate parameters using the Genetic Algorithm ('GA') with more noise (10 dB)
RunInverse(1, 10, 'GA')

% Estimate parameters using Levenberg-Marquardt (method 2) with less noise (25 dB)
RunInverse(1, 25, 2)
```


## üôè Acknowledgments
This toolbox was developed by extending and adapting the foundational work of Mansour Torabi. Many of the core functions for symbolic derivation and animation are based on his original repository (https://github.com/Mansourt/Matlab_Euler-Lagrange_Library_for_Deriving_Equations_of_Dynamic_Systems). We are grateful for his contribution to the open-source community.
